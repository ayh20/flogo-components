package f1telemetry2022

import (
	"bytes"
	"encoding/hex"
	"fmt"

	//"io/ioutil"
	"testing"

	"github.com/lunixbochs/struc"
	"github.com/project-flogo/core/activity"
	"github.com/project-flogo/core/support/test"
	"github.com/stretchr/testify/assert"
)

func TestRegister(t *testing.T) {

	ref := activity.GetRef(&Activity{})
	act := activity.Get(ref)

	assert.NotNil(t, act)
}

/* func TestEval(t *testing.T) {

	act := &Activity{}
	tc := test.NewActivityContext(act.Metadata())

	aInput := &Input{XmlData: `<?xml version="1.0" encoding="UTF-8"?><hello>world</hello>`}
	tc.SetInputObject(aInput)
	done, _ := act.Eval(tc)
	assert.True(t, done)
	aOutput := &Output{}
	err := tc.GetOutputObject(aOutput)
	assert.Nil(t, err)
	assert.Equal(t, "world", aOutput.JsonObject["hello"])
} */

func TestEvalQuality(t *testing.T) {

	act := &Activity{}
	tc := test.NewActivityContext(act.Metadata())

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 3 - Event Data ###############################################################")

	var buf bytes.Buffer

	arr, err1 := hex.DecodeString("e5070103010337722835cfc8e568388a8b41ae01000013ff4255544e0000000003000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}

	tc.SetInput("buffer", arr)
	err := struc.Pack(&buf, arr)

	o := &F1Header{}

	err = struc.Unpack(&buf, o)
	if err != nil {
		fmt.Printf("error code: %v \n", err)
		return
	}

	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype := tc.GetOutput("msgtype")
	rdata := tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 3 -Button Event ###############################################################")

	arr, err1 = hex.DecodeString("e507010401030000000000000000000000000000000013ff4255544e5000000003000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 0 - Motion Data ###############################################################")

	arr, err1 = hex.DecodeString("e5070103010037722835cfc8e568e1a08b41ae01000013ffa6e016c4c0223f4033ba34c3903151c240de7abe334e7fc209af75ffdf9c2163600008af2287dfbeaa63843ebd9e253e7f3a1dc00034a3bb845041bb376917c455653e40982c36c3275051c22c0c23bef52280c22eaf8dffc19c3f6357002daf4009e2be98717d3efecaaa3e7e521dc000c78cbb34392ebb4b6412c4976346403ab91dc356b74fc2c9b7acbdd5f073c22baddbff6c9e9361d0002bad8446d5be91169a3e4c91a83dc8031cc00004b7bbc32bd0bb076017c498723e40288f35c35d5651c2b25539be868080c25aaf85ff9d9c63637c0059afa6571cbf3e5d883eae0f9d3ec76e1dc000adaebb211579bb602016c430cc4040df822fc36ed750c28d0ba1be77e47cc2a9ae62ff2d9dd2626f00a9ae153ae7beeb1e8d3eee4361bcc6fc1cc000acbabb2c365ebbf16a18c434ce3d40f43d3cc34b1f51c2dd123d3cbc1981c291afb5ff709c9063640091afbb0cbfbe2e94803e0bc421be87921dc0002e7cbbf1aa49bbeaf616c42ff53d40c1df35c31e4a4fc2b13562be9b5a7dc218af78ffd39c2d63530018afcb18d5be1ed67d3e4c2f163e82441dc000d196bbacf326bb215415c4354d4140261e2ec390924fc280d59abe994f7ac272ae54ff5b9da5626e0071ae5713debedff7843e7d9622bdcfd81cc00071c3bb51f35dbb8fd813c4a75144403e8d26c3440650c22af4c7be819677c2d9ad53ffda9d25628400d8ad8b7bd9bec6af923ea46085be80751cc000ccd4bb2f8a84bb5acd13c4d4324540e43025c3b8694fc28aa4adbec38076c2c4ad60ffec9d14628900c3ad5b24dfbe2d51903ee8e4afbeb9671cc000c9d0bbc6a889bb1aa617c4362c3e402e2438c32c4452c2c9d3aabd460f81c24dafadffa79c596358004dafea52dcbe8639833eb3c9a43e8b661dc0001273bb851e31bb3f3314c4a9ac4340e9e827c32e1850c2dda9cfbe015b78c2faad5fffbf9d41628300faadecdbeebe8f318e3e3019c63c068b1cc00004cdbb40f883bbd88614c4c4eb4240aaac27c3d6f54fc243fcccbef8417ac25fae61ff6b9d956284005eaef26cf1be769c943e49d3e63d99cc1cc0002eccbb6bad84bb2fd216c408de3e40ea8834c3214451c21d2d80beae497fc202af74ffe49c1c63600002af9ccfe0be5a89833e9ca52b3e6a361dc00032a3bb816f40bbf73614c46d704340009b28c35bf450c294d4cabee39079c201ae5effb99d4762840001aec655ecbe064b963ef4ccd13da08f1cc000d2cdbb46d284bb10ac19c49dfc3c40100541c311d04fc215960fbeeb3f81c2efafa4ff249cdb637d00efaf950bbbbe4216653e186889bdbbce1dc000959bbb27057abb25cd11c484a9464061361bc38e364fc27710c0bd574672c2f2acc7ff9d9e6261e200f2aceb31c7be0c6b9e3e4e5a5bbe55de1bc0007ad1bbe536e2bb8cda16c421373f40717f34c30c9c4fc2c7b380be294e7dc204af79ffe39c1d635f0003af644ae2be5450743ec8841a3e3d371dc000fa9fbb686f3fbbff3011c48737474027261ac306814ec2052d19bd61bd70c2caacb3ffbf9e4061eb00caac55ddb7be4dfca73e6c8c93bee7c31bc00083e5bb5fdeebbb36f004c485035240ffe3bcc25bc43fc266bfb7bdbc4c44c2c1a68bff41a4bf5b8900c1a6f85122bf459a1abf9c50743e33ae17c00029b4bb4a4889bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000391623402abdb3bfecc68541d2565541cba26741670ad740af628741cfbf8c413cec81431cb89ac36860ad4329014d43e45e894249188942477089429421894238cfa6386061ae38e2cd1c3a22ca0e3a89c8153e391d203e0b368942bb9bcb3c5d43b9bdcf10c7bcbf259c3f0c126ebdfadda3bf0141a03b")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 1 - Session Data ###############################################################")

	arr, err1 = hex.DecodeString("e5070103010137722835cfc8e568e1a08b41ae01000013ff001c14c8b5140900000000f0003c0000ff001472a11f3b004d52403d0064fcd13d00e5530d3e00db5c423e0076246a3e007583883e007fef9a3e001bf2aa3e00f8cecc3e00df10e93e00ca5e043f007cba0f3f00a4f21d3f00da12273f0021bb373f00acdb423f005866513f005e895f3f00137e663f0000000000000000060900001c021502030905001c02150203090a001c021502030a00011d001502070a05011c011502070a0a011c0215020c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001f8539bead8539bead8539bead000000010303010101010201")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 2 - Lap Data ###############################################################")

	arr, err1 = hex.DecodeString("e5070103010237722835cfc8e56869268c41b001000013ff00000000c930000000000000bdf85744bdf85744000000800701000000000000000000010200000000000000000000c9300000000000004696584446965844000000800401000000000000000000010200000000000000000000c9300000000000001fa250441fa25044000000801101000000000000000000010200000000000000000000c9300000000000002472584424725844000000800501000000000000000000010200000000000000000000c930000000000000e5785644e5785644000000800a01000000000000000000010200000000000000000000c930000000000000a3685a44a3685a44000000800201000000000000000000010200000000000000000000c930000000000000aa3d5844aa3d5844000000800601000000000000000000010200000000000000000000c930000000000000d6b15544d6b15544000000800b01000000000000000000010200000000000000000000c930000000000000ca475344ca475344000000800f01000000000000000000010200000000000000000000c93000000000000049fb524449fb5244000000801001000000000000000000010200000000000000000000c9300000000000005221594452215944000000800301000000000000000000010200000000000000000000c9300000000000001cc553441cc55344000000800e01000000000000000000010200000000000000000000c930000000000000c1ee5344c1ee5344000000800c01000000000000000000010200000000000000000000c9300000000000002be657442be65744000000800901000000000000000000010200000000000000000000c930000000000000efeb5344efeb5344000000800d01000000000000000000010200000000000000000000c930000000000000351d5c44351d5c44000000800101000000000000000000010200000000000000000000c9300000000000003dc44f443dc44f44000000801201000000000000000000010200000000000000000000c930000000000000b0e65744b0e65744000000800801000000000000000000010200000000000000000000c930000000000000dc2a4f44dc2a4f44000000801301000000000000000000010200000000000000000000c9300000000000009cad3b449cad3b4400000080140100000000000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 4 - Paricipants ###############################################################")
	arr, err1 = hex.DecodeString("e5070103010437722835cfc8e5684ab78b41af01000013ff140103ff05000e4d414c4f4e534f00000000000000000000000000000000000000000000000000000000000000000000000000000000000001010dff0400051d56455454454c000000000000000000000000000000000000000000000000000000000000000000000000000000000000010132ff03003f0a52555353454c4c0000000000000000000000000000000000000000000000000000000000000000000000000000000000010136ff0800040a4e4f5252495300000000000000000000000000000000000000000000000000000000000000000000000000000000000001015eff0600162b5453554e4f4441000000000000000000000000000000000000000000000000000000000000000000000000000000000001010fff00004d1b424f5454415300000000000000000000000000000000000000000000000000000000000000000000000000000000000001010eff02000b34504552455a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000010100ff0100374d5341494e5a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001014aff0900632947494f56494e415a5a490000000000000000000000000000000000000000000000000000000000000000000000000000010151ff07002f1d534348554d41434845520000000000000000000000000000000000000000000000000000000000000000000000000000010102ff0800030352494343494152444f000000000000000000000000000000000000000000000000000000000000000000000000000000010106ff0900071b52c384494b4bc3964e454e00000000000000000000000000000000000000000000000000000000000000000000000000010111ff05001f1c4f434f4e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010113ff0400120d5354524f4c4c00000000000000000000000000000000000000000000000000000000000000000000000000000000000001013bff06000a1c4741534c5900000000000000000000000000000000000000000000000000000000000000000000000000000000000000010109ff020021165645525354415050454e000000000000000000000000000000000000000000000000000000000000000000000000000001014fff070009004d415a4550494e000000000000000000000000000000000000000000000000000000000000000000000000000000000001013aff010010354c45434c455243000000000000000000000000000000000000000000000000000000000000000000000000000000000001013fff0300060d4c4154494649000000000000000000000000000000000000000000000000000000000000000000000000000000000000010007ff00002c0a48414d494c544f4e000000000000000000000000000000000000000000000000000000000000000000000000000000000100ffffff0000ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffff0000ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 5 - Setup Data ###############################################################")
	arr, err1 = hex.DecodeString("e5070103010537722835cfc8e568e1a08b41ae01000013ff08084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e04008084b4b000040c09a9999bfec51b83d86ebd13e0802080103075f3acdccb841cdccb8419a99b1419a99b141060000e0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 6 - Car Telemtery ######################################################")
	arr, err1 = hex.DecodeString("e5070103010637722835cfc8e5684ab78b41af01000013ff29010000803fa9b3153c000000000008792801000100fe01fd01c901c701575555545c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000029010000803f63c81e3c000000000008932801000100fd01fb01c701c501585555545c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000020010000803f4ab2213c000000000007392d0142e3030e020c02dd01db01565452525c5c5c5c5a00cdccb841cdccb8419a99b1419a99b141000000002a010000803fd9fc4c3c000000000008a62801001000ff01fe01c901c701575555555c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000027010000803f767c333c00000000000837280100030004020202cf01cd01575554545c5c5c5c5a00cdccb841cdccb8419a99b1419a99b141000000002b010000803f414e1d3c000000000008be2801000f00f601f501c101bf01585656555c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000026010000803f81080c3c000000000008242801000040f901f701c601c401585555555c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000024010000803f7b8a2f3c000000000007e32d0155e17ffd01fb01cc01c901575554545c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000023010000803f1e540f3c000000000007a32d014ee10f09020702d601d401565452525c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000022010000803f4a2e323c000000000007772d0149e10706020402d501d301565452535c5c5c5c5a00cdccb841cdccb8419a99b1419a99b141000000002b010000803f1e540f3c000000000008d42801001000fe01fc01c701c501585555555c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000023010000803ffd8e243c000000000007ba2d0150e70f08020602d501d301565452525c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000024010000803f89d01b3c000000000007ec2d0156ff7f09020802d601d401575454535c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000029010000803f4ab2213c0000000000087b28010000000002fe01ca01c801575555545c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000025010000803fedc9183c000000000007ef2d0156e37f0a020802d601d401565453535c5c5c5c5a00cdccb841cdccb8419a99b1419a99b141000000002a010000803f53fcfb3b000000000008aa2801000000f001ef01bb01b901585656565c5c5c5c5a00cdccb841cdccb8419a99b1419a99b141000000001f010000803f6d232a3c000000000007ff2c013be1010f020d02e001dd01565452525c5c5c5c5a00cdccb841cdccb8419a99b1419a99b1410000000026010000803ffd8e243c000000000008282801000100f801f701c601c301575555545c5c5c5c5a00cdccb841cdccb8419a99b1419a99b141000000001d010000803f4a2e323c000000000007c72c0135e30011020f02e201df01565451525c5c5c5c5a00cdccb841cdccb8419a99b1419a99b14100000000f600000000002df8513e0000000000078526010000000d020c02d801d7015b5c585c5c5c5c5c5d00cdccb841cdccb8419a99b1419a99b14100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffff00")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 7 - Car Status  ###########################################################")
	arr, err1 = hex.DecodeString("e5070103010737722835cfc8e56869268c41b001000013ff0001013c00b58ed7400000dc421e5c6940c832d70e0900000011100000e7b4544a02d7c552483cd623486d441449000001013c00d089d7400000dc42bd566940c832cc100900000011100000731b554a02a6915148537824484c321549000001013c009226d8400000dc4200036a40c832cc10090000001110000033275c4a02c72b5248fe354f482a6e0d49000001013c001ca1d7400000dc4257706940c832cc100900000011100000d83b564a02e3395148155330485e6d1249000001013c003df1d7400000dc4265c86940c832ab0d09000000111000007ebf594a024d39544877d8354832f71149000001013c003f91d7400000dc42e85e6940c832cc1009000000111000007048554a028a304c483c681e48914c1549000001013c00d8a7d7400000dc42bd776940c832ab0d09000000111000000d55554a02be9849480763294871631549000001013c00b4aad7400000dc42e27a6940c832cc1009000000111000006a45554a020cf749480322374867c01349000001013c0021d3d7400000dc424ea76940c832cc10090000001110000008f6574a0231a65448c786414875e20f49000001013c00f7dbd7400000dc4204b16940c832cc1009000000111000001da8574a02f87f4e4835994248cec51049000001013c008396d7400000dc42b1646940c832cc100900000011100000f4a5554a023895524823982348319e1349000001013c00bf03d8400000dc42bbdc6940c832cc10090000001110000028ad5a4a021cb05448a86e3e4830a91049000001013c0065d7d7400000dc42feab6940c832d70e0900000011100000a779584a02b5a352483ede4a48ad9a0e49000001013c00468fd7400000dc42bd5c6940c832cc10090000001110000004e7554a029b1655486079264867b81349000001013c00921fd8400000dc424ffb6940c832ab0d0900000011100000e8935b4a0265ae5248905e474814c80d49000001013c00d54bd7400000dc42a1126940c832ab0d0900000011100000bed6504a0272f747489cf004483d2c1b49000001013c00ae10d8400000dc42f2ea6940c832cc10090000001110000077a1594a029e8c514815f05248db800c49000001013c00f981d7400000dc421f4e6940c832cc100900000011100000c7c2524a026fba48488b631f48c37a1749000001013c00192cd8400000dc4213096a40c832cc100900000011100000a2435c4a02c1015248a0525d48e1760a49000201013a000d97db400000dc428fca6d40c832cc100900000011100000b90d634a02563dce47726f884819c1ab480000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 8 - Final Classification  ###########################################################")
	arr, err1 = hex.DecodeString("e507010501088a091923dc89785e000000000000000013ff14080101000003fa690100000000e0a72a5740000001110000000000000010000000000000000b0101000003c36a0100000000a08037574000000111000000000000001000000000000000040101000003f368010000000020d7195740000001110000000000000010000000000000000d0101000003eb6c010000000020da5a5740000001110000000000000010000000000000000201010000038a6601000000004057f25640000001110000000000000010000000000000000901010000034e6a0100000000800d30574000000111000000000000001000000000000000030101000003056701000000000031fa5640000001110000000000000010000000000000000e0101000003006d010000000080345c5740000001110000000000000010000000000000001001010000038a6f010000000040d2855740000001110000000000000010000000000000000a0101000003906a0100000000804434574000000111000000000000001000000000000000130101000003b9730100000000c053ca5740000001110000000000000010000000000000001201010000038d710100000000c0bba6574000000111000000000000001000000000000000050101000003f468010000000040e01957400000011100000000000000100000000000000011010100000385700100000000c0e1955740000001110000000000000010000000000000000c0101000003d56b0100000000800a49574000000111000000000000001000000000000000140101000003bd7301000000008094ca5740000001110000000000000010000000000000000f0101000003fe6e010000000080dc7c574000000111000000000000001000000000000000070101000003f4690100000000403f2a57400000011100000000000000100000000000000006010100000315690100000000a0061c57400000011100000000000000100000000000000001010100000373570100000000e018fb5540000001110000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}
	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 9 -Lobby info  ###########################################################")
	arr, err1 = hex.DecodeString("000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	//act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 10 - Car Damage  ###########################################################")
	arr, err1 = hex.DecodeString("e5070104010a16d8a29b8990560251f0be42990b000013ffc895aa3fac7a903fbd48923f0417863f0101010100000000000000000000000000000000000000cd8ea13fb9eb893fb8cd863fbed07a3f0101010000000000000000000000000000000000000000d726a93fe62a903f35668e3f084b843f0101010100000000000000000000000000000000000000bbe0a53f9c048d3fa73d8c3fe4d8823f0101010100000000000000000000000000000000000000a768a43f63278d3f78758a3f392e803f0101010100000000000000000000000000000000000000b08bab3f86c7913faaca8f3f5b47853f0101010100000000000000000000000000000000000000c0a7a73f3b598d3f5fe68f3f4b1d853f01010101000000000000000000000000000000000000009a5caa3f676e913fb19b8e3f1c7d843f0101010100000000000000000000000000000000000000e17da93f3432903f0191903f09b1843f01010101000000000000000000000000000000000000001406a93f56ac8f3f7fdd8d3f896d833f01010101000000000000000000000000000000000000000a83a73f13e78d3fbc8a8f3f25e8833f01010101000000000000000000000000000000000000004af0b03fc01b973f8f16963fe6d1893f0101010100000000000000000000000000000000000000c4adad3fd4f7943fef58963f1b79893f01010101000000000000000000000000000000000000002c30a13fb88c883f99da863fa3037d3f0101010000000000000000000000000000000000000000f5b4a63f50698c3f83678e3f1f1c823f0101010100000000000000000000000000000000000000ed3fa23fc4d4893fcb468b3fdc5c7e3f01010100000000000000000000000000000000000000006a87a33f006c8a3f1bb48d3fcaba803f0101010100000000000000000000000000000000000000d9dcae3f77c0943fd779953f9558883f0101010100000000000000000000000000000000000000a726a83ff522903ffbc58c3f0b08833f0101010100000000000000000000000000000000000000b56c0340b741e13ff0e40e403274e83f0201020100000000000000000000000000000001000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")

	fmt.Println("#######   Testing -  MSGTYPE 11 - Session History  ###########################################################")
	arr, err1 = hex.DecodeString("e5070104010b16d8a29b89905602000000000000000013ff130201010101017c6101000b71bb5bb5940f000000000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff1110000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}
}

package f1telemetry2022

import (
	"bytes"
	"encoding/hex"
	"fmt"

	//"io/ioutil"
	"testing"

	"github.com/lunixbochs/struc"
	"github.com/project-flogo/core/activity"
	"github.com/project-flogo/core/support/test"
	"github.com/stretchr/testify/assert"
)

func TestRegister(t *testing.T) {

	ref := activity.GetRef(&Activity{})
	act := activity.Get(ref)

	assert.NotNil(t, act)
}

/* func TestEval(t *testing.T) {

	act := &Activity{}
	tc := test.NewActivityContext(act.Metadata())

	aInput := &Input{XmlData: `<?xml version="1.0" encoding="UTF-8"?><hello>world</hello>`}
	tc.SetInputObject(aInput)
	done, _ := act.Eval(tc)
	assert.True(t, done)
	aOutput := &Output{}
	err := tc.GetOutputObject(aOutput)
	assert.Nil(t, err)
	assert.Equal(t, "world", aOutput.JsonObject["hello"])
} */

func TestEvalQuality(t *testing.T) {

	act := &Activity{}
	tc := test.NewActivityContext(act.Metadata())

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 3 - Event Data ###############################################################")

	var buf bytes.Buffer

	arr, err1 := hex.DecodeString("e60701060103aa00fd8a6f2ffe452f033542c503000013ff4255544e000102005a172d575a172d57")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}

	tc.SetInput("buffer", arr)
	err := struc.Pack(&buf, arr)

	o := &F1Header{}

	err = struc.Unpack(&buf, o)
	if err != nil {
		fmt.Printf("error code: %v \n", err)
		return
	}

	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype := tc.GetOutput("msgtype")
	rdata := tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 3 -Button Event ###############################################################")

	arr, err1 = hex.DecodeString("e60701060103aa00fd8a6f2ffe452f033542c503000013ff4255544e000102005a172d575a172d57")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 0 - Motion Data ###############################################################")

	arr, err1 = hex.DecodeString("e60701060100aa00fd8a6f2ffe45b6f63442c403000013ff287a4441aca55140be7440c4f7945342448a14be0a8b2d42f8619eff5e52a6adf5fcef61f0b714c0bf0a023fde6a33be322d5f3f001b55bc2ae6c23c84cc8d4227184840c6912dc4c2a2ff41656f873ecbaa8742363583006874a38bbcfc35350f2b0dc023e0c83ee9a47c3e1d99db3ec0edcbbc752dd13c65e4b341c3944e40a5353ec4d1704d42894a4cbe204541421a5cb0ffe15824a721fd135caff01fc0bd22fa3e86a1913c76a54d3f806c62bc6cc7b73c0dc70342f3914d404bc53bc49cfb4242c6d145be40a450423156b5ff9f5e67a102fd2a5695911ec0273ce43e98f83abcd22a3d3f40e180bc4f88bf3cb85dfa4102974d40a0243cc489ad4342545b2fbe5d3b4e42ef56cbfff15d15a202fde856679a1cc0b297e63e467171bde22c3f3f408f83bc33a7bf3cac395d4203fa4540434b34c492f61d429c7d0bbe28397642bc43f2ff9a6c6e93f9fcb74309b321c0cebcba3e5abf2c3e6fcb0e3fc0a7a2bc77ebc13c78b8fb417ac34c4089f53bc4725f43420c613bbe572850426856c3ff6d5e99a106fd615660b81ec05b24ed3ee05becbcbfbf3d3f004f82bcdb9cbe3c60fb244228964a404b6939c47c5337421c7830be884b5d425b50d2ffa063669c11fd55509f0420c0adeed33e92d3533e67ca2d3f80078bbc45fdbb3c6e3a8342a13645400dd52fc46c69084237e59b3d250e8342d0393f003172d88dcffccd3905c810c0a0c6b93e5c71533eec05f03ec092bdbc3c66cc3ca37192412cbf4f4089513fc43c61524293b21fbe196238422a5fc8ff97556eaaf2fc235f678221c00654f63ef462793ef4a3563f00a570bcfabac33cf7e43c42d1d74840b54b37c442b62c42304636be678168420e4bc3ffad67599803fd084bc3201ec0f058c83ed888213cd271203fc00292bc044fbf3c47819e4163e14f40ecd33ec49d874f42b0b726be455c3c42aa5dbfff3b57c9a821fda35d8c0d19c0cbb8fe3e321066bda72f523f00c562bc86e6b73cda14d84111a54d40a41c3dc4aa4548426c0df6bd839e48424159d8ffbd5b49a4f1fc3a595e0b21c0107dfc3e624e0b3e0d95453f404985bcaee5c33c56c26442996545404b8c33c46d6b1b42467d21bddb4f7b42ec41e4ffb66d519201fde741be9926c0e535c3befb16213e2c8a0a3f40e2a0bc14f3bf3cb17aa9417bdc4f4035ad3ec4fb3b504211a029be609d3d42865db2ff6257a3a8f3fc7e5d20401dc0124cef3e58d91cbcd9c6513f00e06dbc7147c33c5ddf5d4148235240a24340c460735642d29a40bed8fb3042a661a8ffbf5246adeafc9e61a1761ac0439c063fb5cf15bed9305e3f80cc5dbcf0a3c53cbbeffb3f8dca54407c8942c417645f42fda980be7b761d42ad67b3ff0e4bf4b45efda76772f117c085c10a3f6c0de7bdcdb9713f805c26bc38c0a83ccfe7384251094a4027d937c438bf3042caad0fbef7a366428b4ccdff956671991ffd864c527c23c0ff3dca3eeaca013e4a23243f002f8cbc1583b83c2edb70428b094540774932c474771442e528acbd42df7e42053febff676fa190eafc003ff74921c0eaa231bf8c8be53de4d2033fc043a9bc3d87c53c0b9dbb4287556040b0a81bc4d54f77414d92393edfda92429c196a00687da08251fd9d199f8a9fbffe005d3ec71c38bed1544e3e40bcadbc1fe7ab3c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000560756424eff48424b9a5042b63c4842df518ec1185284beca7aedc015fdc9c0e6c42d43a1bcc64429f8cd444de21a4461fa9742da8d9742ca479642eabc95425508373c72133e3c1a2f8cb9c8a0a5b928d6e63e80e791bd3912964285b768bcd8e524be82a94dbc025f48bfcd1925bc32ba95be40d7233c")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 1 - Session Data ###############################################################")

	arr, err1 = hex.DecodeString("e60701060101aa00fd8a6f2ffe4516153442c003000013ff011c13019c140900000000f000500000ff0014b03b2e3b00b53d423d00cf0dd83d0070d50d3e00d232433e0039d16a3e001a0a893e0001499b3e00580fac3e0007facc3e004637e93e00a0e7023f00d5400e3f00bc841c3f008fa3253f00a066363f00aeb9413f004b66513f007f8a5f3f00217d663f0000000000000000060900011c021402060905011c02140206090a011c021301060a00011b0113010e0a05011b0213020d0a0a011b0213020d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029a31ad129a31ad129a31ad10000000001030101010002010300c003000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 2 - Lap Data ###############################################################")

	arr, err1 = hex.DecodeString("e60701060102aa00fd8a6f2ffe45b6f63442c403000013ff000000005e9c0000297f000013320845133208450000008013010000010000000000000102000000000000000000005b9c0000027b00004a510e454a510e450000008002010000010000000000000102000000000000000000005a9c0000c57e00004a1109454a110945000000800e01000001000000000000010200000000000000000000579c0000077e00005cfa09455cfa0945000000800a010000010000000000000102000000000000000000005a9c00002f7e000059d6094559d60945000000800c01000001000000000000010200000000000000000000609c0000587c0000815b0c45815b0c45000000800601000001000000000000010200000000000000000000609c0000297e000019e1094519e10945000000800b01000001000000000000010200000000000000000000569c0000697d00006cc70a456cc70a450000008009010000010000000000000102000000000000000000005d9c0000437b000099a90d4599a90d45000000800301000001000000000000010200000000000000000000579c0000e67e000093ad084593ad0845000000801101000001000000000000010200000000000000000000599c0000067d000005700b4505700b45000000800701000001000000000000010200000000000000000000619c0000cb7e000095d5084595d50845000000801001000001000000000000010200000000000000000000599c0000537e00006378094563780945000000800d01000001000000000000010200000000000000000000579c00004f7c000001950c4501950c45000000800501000001000000000000010200000000000000000000609c0000cb7e0000c5ec0845c5ec0845000000800f010000010000000000000102000000000000000000005b9c0000317f0000094e0845094e0845000000801201000001000000000000010200000000000000000000579c0000e57f00005259074552590745000000801401000001000000000000010200000000000000000000589c00001e7d000055490b4555490b45000000800801000001000000000000010200000000000000000000579c0000f97b00007ef40c457ef40c45000000800401000001000000000000010200000000000000000000589c0000cb790000650213456502134500000080010100000100000000000001020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffff")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 4 - Paricipants ###############################################################")
	arr, err1 = hex.DecodeString("e607010701048dd61b3b32f5497be7a8f2409e00000013ff14013eff03001750414c424f4e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000010109ff020021165645525354415050454e000000000000000000000000000000000000000000000000000000000000000000000000000001015eff0600162b5453554e4f4441000000000000000000000000000000000000000000000000000000000000000000000000000000000001013bff06000a1c4741534c5900000000000000000000000000000000000000000000000000000000000000000000000000000000000000010102ff0800030352494343494152444f000000000000000000000000000000000000000000000000000000000000000000000000000000010107ff00002c0a48414d494c544f4e00000000000000000000000000000000000000000000000000000000000000000000000000000000010111ff05001f1c4f434f4e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010fff09004d1b424f5454415300000000000000000000000000000000000000000000000000000000000000000000000000000000000001013aff010010354c45434c4552430000000000000000000000000000000000000000000000000000000000000000000000000000000000010150ff0900180f4755414e5955000000000000000000000000000000000000000000000000000000000000000000000000000000000000010136ff0800040a4e4f5252495300000000000000000000000000000000000000000000000000000000000000000000000000000000000001010dff0400051d56455454454c00000000000000000000000000000000000000000000000000000000000000000000000000000000000001010bff070014154d41474e555353454e00000000000000000000000000000000000000000000000000000000000000000000000000000001010eff02000b3450c38952455a000000000000000000000000000000000000000000000000000000000000000000000000000000000000010151ff07002f1d534348554d41434845520000000000000000000000000000000000000000000000000000000000000000000000000000010113ff0400120d5354524f4c4c00000000000000000000000000000000000000000000000000000000000000000000000000000000000001013fff0300060d4c4154494649000000000000000000000000000000000000000000000000000000000000000000000000000000000000010103ff05000e4d414c4f4e534f000000000000000000000000000000000000000000000000000000000000000000000000000000000000010100ff0100374d5341494e5a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000010032ff00003f0a52555353454c4c00000000000000000000000000000000000000000000000000000000000000000000000000000000000100ffffff0000ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffff0000ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 5 - Setup Data ###############################################################")
	arr, err1 = hex.DecodeString("e60701060105aa00fd8a6f2ffe45b4143242b603000013ff121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e040121c503c000040c00000c0bfcecccc3dae47e13e0a010a01030464360000aa410000aa410000ba410000ba41060000e0400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 6 - Car Telemtery ######################################################")
	arr, err1 = hex.DecodeString("e60701060106aa00fd8a6f2ffe451e973242b903000013ffea000000803fa783bd3d000000000006fb290000000050024f0228022402646464645c5c5c5c6e000000b6410000b6410000be410000be410000000007010000803f6959b93d0000000000060a2f000000002d022c02e001de01646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f3000000803fee24c73d000000000006892b001100004d024c021f021d02646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f7000000803fc3b2c23d0000000000063b2c002400004902470214021202646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f6000000803f741ec53d000000000006112c002100004202410210020e02646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000ff000000803fbea8b83d000000000006a22d004de07f32023102f201f001646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f7000000803f4d8bc53d000000000006372c002500004702460214021102646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f9000000803fe03ac53d000000000006a22c002f60003d023c0205020202646464645c5c5c5c6e000000b6410000b6410000be410000be410000000002010000803f17b2b23d000000000006222e005be03f2b022a02e301e101646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f1000000803fdbf4bd3d000000000006252b000601004c024b0220021e02646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000fc000000803f533dbc3d000000000006152d003ce0013a0239020002fd01646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f1000000803f6ea5c13d000000000006432b000900004d024c0220021d02646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f5000000803f0d75c93d000000000006d32b001900004c024b021b021802646464645c5c5c5c6e000000b6410000b6410000be410000be410000000002010000803f6a5ab63d000000000006322e005de07f37023602f401f201646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000f3000000803fee4dc23d000000000006712b000e00005102500223022002646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000ef000000803faa54ba3d000000000006cb2a000000005202510228022602646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000ea000000803f564fb93d000000000006ef29000000005902580235023202646464645c5c5c5c6e000000b6410000b6410000be410000be4100000000fc000000803f675cc03d0000000000062d2d003fe0034102400206020402646464645c5c5c5c6e000000b6410000b6410000be410000be410000000003010000803fd695b93d0000000000063d2e005fe07f2d022c02e901e701646464645c5c5c5c6e000000b6410000b6410000be410000be410000000009010000803fa098983dc0f03f3d00071d2a00000000f102f002ac02aa02695c625f605e605f760005a5ab41a9beaa4165dbbb41ca7ebb4100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffff00")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 7 - Car Status  ###########################################################")
	arr, err1 = hex.DecodeString("e607010701078dd61b3b32f5497be7c2e7409700000013ff000101360044e2df400000dc42f0c67a40c832ab0d0900000010100000c8d1734a0200000000f52fb2459a4f2b46000001013600ede8df400000dc4282ce7a40c832ab0d0900000010100000e7d3734a0200000000b5c7b4454a7b2a46000001013600b1d5df400000dc42a7b87a40c832ab0d09000000101000001ece734a020000000097e0b24581542f46000001013600f0e4df400000dc42fac97a40c832ab0d09000000101000001ad3734a02000000007dd2b1454ad02946000001013600c1e5df400000dc42e7ca7a40c832ab0d0900000010100000c6d2734a0200000000c0ecb0450eaf294600000101360016d6df400000dc4219b97a40c832ab0d090000001010000021cf734a02000000006dfcb345dbde2e4600000101360003d9df400000dc426cbc7a40c832ab0d0900000010100000a7d1734a02000000008d8eb545c8212d46000001013600d5d4df400000dc42adb77a40c832ab0d090000001010000026ce734a0200000000f8f9b24590572f4600000101360047e9df400000dc42e8ce7a40c832ab0d0900000010100000e3d3734a02000000006012b34551a72946000001013600f8e3df400000dc42e0c87a40c832ab0d0900000010100000cad3734a020000000058e7b1451b2a2946000001013600abd8df400000dc4208bc7a40c832ab0d09000000101000001bce734a020000000069e5b1453dd92e46000001013600d2dbdf400000dc429dbf7a40c832ab0d090000001010000070d0734a02000000001a33b2455da72c4600000101360003e3df400000dc42cac77a40c832ab0d0900000010100000ecd4734a0200000000b2abb445e06a2946000001013600d5e7df400000dc4244cd7a40c832ab0d09000000101000008dd3734a020000000018d6b44559dc2a460000010136009cdcdf400000dc4283c07a40c832ab0d0900000010100000a2d3734a02000000006ee4b44577d12a46000001013600d6dcdf400000dc42c5c07a40c832ab0d090000001010000041d0734a0200000000503ab2451adc2c4600000101360063d7df400000dc4294ba7a40c832ab0d090000001010000093ce734a020000000010e2b24500de2e460000010136000ad9df400000dc4274bc7a40c832ab0d0900000010100000a0d1734a0200000000f27cb545ae212d46000001013600fadadf400000dc42a8be7a40c832ab0d090000001010000034ce734a02000000006400b44549ce2f460002010136007004da400000dc42511c7440c832ab0d09000000101000000024744a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 8 - Final Classification  ###########################################################")
	arr, err1 = hex.DecodeString("e607010701088dd61b3b32f5497b000000000000000013ff1411010100000386670100000000407802574000000110000000000000001000000000000000ff00000000000000020101000003795f010000000080907e564000000110000000000000001000000000000000ff000000000000000b0101000003516501000000008047de564000000110000000000000001000000000000000ff000000000000000c010100000382650100000000e074e1564000000110000000000000001000000000000000ff000000000000000d0101000003af650100000000804ae4564000000110000000000000001000000000000000ff000000000000000601010000039a6101000000000077a1564000000110000000000000001000000000000000ff000000000000000a0101000003ce640100000000a0eed5564000000110000000000000001000000000000000ff00000000000000090101000003c4640100000000c044d5564000000110000000000000001000000000000000ff00000000000000030101000003875f0100000000806f7f564000000110000000000000001000000000000000ff000000000000001301010000035f680100000000c05610574000000110000000000000001000000000000000ff00000000000000080101000003dc630100000000e070c6564000000110000000000000001000000000000000ff000000000000001001010000034d67010000000080d1fe564000000110000000000000001000000000000000ff000000000000000e01010000039166010000000000cdf2564000000110000000000000001000000000000000ff00000000000000040101000003e660010000000040f395564000000110000000000000001000000000000000ff000000000000000f0101000003fc660100000000c0a9f9564000000110000000000000001000000000000000ff00000000000000120101000003f1670100000000004909574000000110000000000000001000000000000000ff000000000000001401010000032c6a010000000040d62d574000000110000000000000001000000000000000ff0000000000000007010100000396620100000000008eb1564000000110000000000000001000000000000000ff000000000000000501010000032c610100000000006d9a564000000110000000000000001000000000000000ff00000000000000010100000003f3550100000000e080e2554000000110000000000000001000000000000000ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}
	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 9 -Lobby info  ###########################################################")
	arr, err1 = hex.DecodeString("000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	//act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")
	fmt.Println("#######   Testing -  MSGTYPE 10 - Car Damage  ###########################################################")
	arr, err1 = hex.DecodeString("e6070106010aaa00fd8a6f2ffe4516153442c003000013ff9266783f6b0a463fd3210a3f4b21163f00000000000000000000000000000000000000000000000000006791843fe8ce463f881e133f7c14233f010000000000000000000000000000000000000000000000000049c6793fe0b2433fa3870d3ffb041a3f0000000000000000000000000000000000000000000000000000ad7d7f3feaaa463f9b310e3f162c1c3f0000000000000000000000000000000000000000000000000000ed2a783fccb0413f87ae073f713e153f0000000000000000000000000000000000000000000000000000cdd9893fb292543fc26e193f5a0a293f010000000000000000000000000000000000000000000000000036117d3f2de2453f2ea80f3fe1791c3f00000000000000000000000000000000000000000000000000008939843f16264d3f3857123fb74d213f01000000000000000000000000000000000000000000000000002589883fc32b503f7740173f3663263f010000000000000000000000000000000000000000000000000062b9773f2204423f3f44053f79f2133f0000000000000000000000000000000000000000000000000000b2b4813f668d473fc3d8103f18801f3f0100000000000000000000000000000000000000000000000000a461723fe1443e3f3ec7063fc6f2123f0000000000000000000000000000000000000000000000000000ca5c7f3f1e6c483ffae30e3f93701c3f0000000000000000000000000000000000000000000000000000d12d7e3f2725423fe0b40e3fd7971d3f000000000000000000000000000000000000000000000000000042a8793f34c2443f2386093f4991163f000000000000000000000000000000000000000000000000000091c56c3f8b0f3a3febb3003f05140d3f00000000000000000000000000000000000000000000000000004b8e723f1c37403ff226023fe7b50f3f00000000000000000000000000000000000000000000000000007ef4823f6203493fb423133f212a223f0100000000000000000000000000000000000000000000000000a2ed863f5aba4e3f9213143ff8f5223f0100000000000000000000000000000000000000000000000000decdec3f140bc13fe323d13fd8d9d13f0101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}

	fmt.Println(" ")

	fmt.Println("#######   Testing -  MSGTYPE 11 - Session History  ###########################################################")
	arr, err1 = hex.DecodeString("e6070106010baa00fd8a6f2ffe4516153442c003000013ff0501010001000000000000587c000000000f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ff1010000000000000000000000000000000000000000000")

	if err1 != nil {
		fmt.Printf("error code: %v \n", err1)
		return
	}
	tc.SetInput("buffer", arr)
	buf.Reset()
	err = struc.Pack(&buf, arr)
	err = struc.Unpack(&buf, o)
	fmt.Printf("F1 Header : \n %+v \n", o)

	fmt.Println("#######   call routine ")
	act.Eval(tc)

	rtype = tc.GetOutput("msgtype")
	rdata = tc.GetOutput("data")

	fmt.Printf("Msg Type: %v \n", rtype)
	fmt.Printf("csv data: %v \n", rdata)

	if tc.GetOutput("msgtype") == nil {
		t.Fail()
	}
}
